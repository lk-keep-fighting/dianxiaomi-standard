# 店小秘自动化系统 - 用户手册 2

欢迎使用店小秘自动化系统！本手册基于 README 中的内容，为终端用户提供一份简洁易用的功能指南。

---

## 1. 系统概览

店小秘自动化系统通过 Playwright 自动完成以下工作：

- 🛒 从 Amazon 商品页面提取产品信息。
- 📝 将数据自动填写到 DataCaciques 表单。
- 🔄 保持统一的数据流，减少重复输入和错误。

核心亮点：统一的 Amazon 解析器、智能表单填充、字段映射一致、全流程日志记录。

---

## 2. 快速开始

### 2.1 系统要求
- Python 3.8 及以上
- macOS / Linux（Windows 用户需使用 WSL）
- 内存 4GB 以上
- 稳定的互联网连接

### 2.2 安装依赖
**推荐：一键脚本**
```bash
cd 店小秘自动化-warp2
./scripts/install_dependencies.sh
```

**手动安装**
```bash
pip install -r requirements.txt
python -m playwright install chromium
```

### 2.3 配置账号信息
在终端中设置 DataCaciques 登录信息：
```bash
export DC_USERNAME="您的用户名"
export DC_PASSWORD="您的密码"
export ENVIRONMENT="production"
```
如需调试，将 `DEBUG` 设置为 `1` 可查看更多日志。

### 2.4 启动系统
```bash
./scripts/run.sh          # 推荐
python src/main.py        # 直接运行
```

### 2.5 验证功能（可选）
```bash
python archive/non_startup_assets/tests/test_refactored_system.py
```

---

## 3. 标准使用流程

1. **启动系统**：运行脚本或 `python src/main.py`，系统会自动开启浏览器。
2. **输入商品链接**：准备 Amazon 商品 URL，例如 `https://www.amazon.com/dp/B0XXXXXXX`。
3. **系统自动解析**：抓取品牌、尺寸、重量、材质、特征等信息。
4. **自动填表**：系统登录 DataCaciques，按映射关系填写表单。
5. **检查与提交**：查看系统输出的填写统计，在表单中确认或调整内容。

---

## 4. 系统能力一览

### 4.1 关键组件
- **Amazon Product Parser**：多策略提取，支持表格解析和错误容错。
- **ProductData & FieldMappingEngine**：统一数据结构与映射逻辑。
- **Unified Form Filler**：支持文本框、下拉框、TinyMCE 等多种表单元素。

### 4.2 可提取字段示例
- 基础信息：品牌、制造商、颜色、材质。
- 尺寸重量：长度、宽度、深度/高度、重量。
- 特征亮点：特殊功能、风格、形状、承重能力。

---

## 5. Windows 一键打包（可选）

如需生成免安装的 Windows 可执行文件：
```powershell
pip install -r requirements.txt
pip install -r requirements-packaging.txt
python scripts/package_windows_exe.py --supabase-url https://your-project.supabase.co --supabase-api-key your-service-role-key
```

- 可通过 `--env-file` 或 `--set KEY=VALUE` 传入环境变量。
- 打包产物位于 `dist/windows/`，双击即可使用。

---

## 6. 常见问题与解决

### 6.1 系统无法启动
```bash
python -m playwright install --with-deps chromium
chmod +x scripts/install_dependencies.sh scripts/run.sh
```

### 6.2 表单字段为空
- 确认 Amazon 页面包含该信息。
- 运行测试检查映射：
  ```bash
  python archive/non_startup_assets/tests/test_refactored_system.py
  ```
- 手动补充缺失内容并重试。

### 6.3 Amazon 数据解析失败
```bash
python -c "from src.system_config import get_config; print(get_config().amazon_selectors)"
```
确认选择器配置无误，必要时更新。

---

## 7. 日志与性能

- **日志**：运行时在终端输出详细步骤；设置 `DEBUG=1` 可获得更多调试信息。
- **性能指标（参考值）**：
  - 平均解析时间：5-10 秒/产品
  - 表单填充成功率：>95%
  - 内存占用：<500MB

---

## 8. 获取帮助

- 查看 `src/product_data.py` 了解字段映射。
- 表单填充问题请检查 `src/unified_form_filler.py`。
- 解析问题请查看 `src/amazon_product_parser.py`。
- 如无法自行解决，请记录日志信息并在项目 Issue 区提交反馈。

---

祝您使用顺利，享受全自动的店铺运营体验！🎉
